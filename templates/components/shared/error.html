{% set error_type = error_type|default('general') %}
{% set error_title = error_title|default('An error occurred') %}
{% set error_message = error_message|default('Something went wrong. Please try again later.') %}
{% set show_actions = show_actions|default(true) %}
{% set retry_trigger = retry_trigger|default('') %}
{% set retry_target = retry_target|default('') %}
{% set retry_indicator = retry_indicator|default('') %}
{% set retry_text = retry_text|default('Try Again') %}
{% set return_url = return_url|default('/dashboard') %}
{% set return_text = return_text|default('Return to Dashboard') %}
{% set toast_duration = toast_duration|default(8000) %}
{% set error_id = error_id|default('error-' ~ range(1000, 9999) | random) %}

<div id="{{ error_id }}" 
     x-data="{ 
        visible: true,
        hide() { 
            this.visible = false;
            setTimeout(() => this.$el.remove(), 500);
        }
     }"
     x-show="visible"
     x-transition:enter="transition ease-out duration-300"
     x-transition:enter-start="opacity-0 transform scale-95"
     x-transition:enter-end="opacity-100 transform scale-100"
     x-transition:leave="transition ease-in duration-300"
     x-transition:leave-start="opacity-100 transform scale-100"
     x-transition:leave-end="opacity-0 transform scale-95"
     class="bg-red-50 dark:bg-red-900/40 border-l-4 border-red-500 p-4 rounded-md mb-4"
     {% if is_toast %}
     x-init="setTimeout(() => hide(), {{ toast_duration }})"
     {% endif %}>
    <div class="flex">
        <div class="flex-shrink-0">
            {% if error_type == 'connection' %}
            <svg class="h-5 w-5 text-red-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-2 0a6 6 0 11-12 0 6 6 0 0112 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zm-1 9a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" />
            </svg>
            {% elif error_type == 'timeout' %}
            <svg class="h-5 w-5 text-red-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd" />
            </svg>
            {% elif error_type == 'server' %}
            <svg class="h-5 w-5 text-red-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
            </svg>
            {% else %}
            <svg class="h-5 w-5 text-red-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
            </svg>
            {% endif %}
        </div>
        <div class="ml-3">
            <h5 class="text-lg font-medium text-red-800 dark:text-red-200">{{ error_title }}</h5>
            <p class="text-red-700 dark:text-red-300 mt-1">{{ error_message }}</p>
            
            {% if show_actions %}
            <div class="mt-3 flex flex-wrap gap-2">
                {% if retry_trigger and retry_target %}
                <button hx-{{ retry_trigger }} 
                        hx-target="{{ retry_target }}"
                        {% if retry_indicator %}hx-indicator="{{ retry_indicator }}"{% endif %}
                        class="px-3 py-1 bg-red-100 dark:bg-red-800 hover:bg-red-200 dark:hover:bg-red-700 text-red-800 dark:text-red-100 rounded-md text-sm transition">
                    {{ retry_text }}
                </button>
                {% endif %}
                
                <a href="{{ return_url }}" 
                   class="px-3 py-1 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md text-sm transition">
                    {{ return_text }}
                </a>
                
                <button @click="hide()" aria-label="Dismiss"
                        class="px-3 py-1 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md text-sm transition">
                    Dismiss
                </button>
            </div>
            {% endif %}
        </div>
    </div>
</div>